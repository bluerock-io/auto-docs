<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>The cpp.class command - BlueRock FM Docs</title>
  
  <link rel="icon" type="image/x-icon" href="../../assets/favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/css/main.css">
</head>
<body>
  <header class="navbar navbar-expand-lg bd-navbar sticky-top bg-light navbar-light">
    <nav class="container-xxl bd-gutter flex-wrap flex-lg-nowrap">
      <a class="navbar-brand" style="font-size: 20pt; font-weight: bolder" href="../../">
       <img src="../../assets/bluerock-cube.svg" style="height: 25pt">
       BlueRock FM Docs
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <div class="input-group" id="searchGroup">
              <span class="input-group-text bg-transparent border-0"><i class="bi bi-search"></i></span>
              <input type="search" id="searchInput" class="form-control bg-transparent border-0 border-bottom text-black" placeholder="Search..." aria-label="Search">
            </div>
          </li>
        </ul>
      </div>
    </nav>
  </header>

    <div class="container-xxl bd-gutter mt-3 my-md-4 bd-layout" style="display: grid; grid-template-areas: 'sidebar main'; grid-template-columns: 1fr 5fr; gap: 0.5rem;">
      <aside class="bd-sidebar" style="grid-area: 'sidebar'">
        



<div class="flex-shrink-0 bg-white" style="min-width: 250pt;">
  <ul class="list-unstyled ps-0 mx-3" id="sidebar">
    
    
      
        

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../">Home</a>
</li>


      
    
      
        

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#quick-start-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../quick-start/">
    Quick Start
  </a>
  <div class="collapse " id="quick-start-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../setup/">Setup</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/simple/test/">Very First Verification</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/state_basics/main/">Basics about Program State</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/primitive_reps/main/">Primitive Data</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/debugging/main/">Exploring Programs in Logic</a>
</li>


        
      
    </ul>
  </div>
</li>


      
    
      
        

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#learn-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../learn/">
    Learn
  </a>
  <div class="collapse " id="learn-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#functions-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../docs/functions/">
    Functions
  </a>
  <div class="collapse " id="functions-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/functions/specification/">Function Specifications</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/functions/verification/">Verifying Some Examples</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#control-flow-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../docs/control-flow/">
    Control Flow
  </a>
  <div class="collapse " id="control-flow-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/control_flow/if/"><code>if</code> Statements</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/control_flow/loop/">Loop Invariants</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#classes-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../docs/class_reps/classes/">
    Classes
  </a>
  <div class="collapse " id="classes-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/class_reps/main/">Class Representation Predicates</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/class_reps/alt/">Class Representation Predicates, alternative</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/rep_hints/main/">Hints about Reps</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/fractional-sharing/intro/">Sharing with Fractional Permissions</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
    </ul>
  </div>
</li>


      
    
      
        

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#troubleshooting-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../troubleshooting/">
    Troubleshooting
  </a>
  <div class="collapse " id="troubleshooting-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../docs/common_errors/missing_type_instances/">Dealing with Missing Type Instances</a>
</li>


        
      
    </ul>
  </div>
</li>


      
    
      
        

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#scaffold-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../scaffold/">
    Scaffold
  </a>
  <div class="collapse " id="scaffold-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../scaffold/getting-started/">Getting Started</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../scaffold/default-specs/">Using Default Specifications</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../scaffold/by_hand/">Providing a Specification by Hand</a>
</li>


        
      
    </ul>
  </div>
</li>


      
    
      
        

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#demos-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../demo/">
    Demos
  </a>
  <div class="collapse " id="demos-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#point-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../demo/aggregate01/README/">
    Point
  </a>
  <div class="collapse " id="point-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/aggregate01/Point.hpp.html">Point.hpp</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/aggregate01/Point_hpp_spec/">Point_hpp_spec.v</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/aggregate01/Point_hpp_proof/">Point_hpp_proof.v</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#basics-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../demo/basic/README/">
    Basics
  </a>
  <div class="collapse " id="basics-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/basic/main.cpp.html">main.cpp</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/basic/main_cpp_proof/">main_cpp_proof.v</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#dataclass-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../demo/data_class/README/">
    Dataclass
  </a>
  <div class="collapse " id="dataclass-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/data_class/main.cpp.html">main.cpp</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/data_class/main_proof/">main_proof.v</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#forward-list-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../demo/forward_list_v1/README/">
    Forward List
  </a>
  <div class="collapse " id="forward-list-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/forward_list_v1/test.cpp.html">test.cpp</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/forward_list_v1/test_cpp_proof/">test_cpp_proof.v</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#inlining-specifications-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../demo/inline/README/">
    Inlining Specifications
  </a>
  <div class="collapse " id="inlining-specifications-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/inline/inline.hpp.html">inline.hpp</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/inline/inline_hpp_spec/">inline_hpp_spec.v</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#singly-linked-list-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../demo/linked_list/README/">
    Singly-linked List
  </a>
  <div class="collapse " id="singly-linked-list-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/linked_list/linked_list.hpp.html">linked_list.hpp</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/linked_list/linked_list.cpp.html">linked_list.cpp</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/linked_list/linked_list_hpp_spec/">linked_list_hpp_spec.v</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/linked_list/linked_list_cpp_proof/">linked_list_cpp_proof.v</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
        
          

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#loops-collapse">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../../demo/loops/README/">
    Loops
  </a>
  <div class="collapse " id="loops-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/loops/main.cpp.html">main.cpp</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../demo/loops/main_cpp_proof/">main_cpp_proof.v</a>
</li>


        
      
    </ul>
  </div>
</li>


        
      
    </ul>
  </div>
</li>


      
    
      
        

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../further-reading/">External Resources</a>
</li>


      
    
      
        

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../../contributing/">Feedback</a>
</li>


      
    
      
        

<li class="mb-1">
  
  <button class="btn sidebar-toggle align-items-center rounded px-1" data-bs-toggle="collapse" data-bs-target="#reference-docs-collapse" aria-expanded="true">
  </button>
  <a class="nav-link px-0" style="display: inline" href="../">
    Reference Docs
  </a>
  <div class="collapse show" id="reference-docs-collapse">
    <ul class="sidebar-toggle-nav list-unstyled fw-normal pb-1 small px-4">
      

      
        
      

      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.core.hints.cancelx_notation/">DSL for defining hints</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.core.hints.orient/">Syntax for defining hints</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.cpp.Arith/">Tactics for arithmetics</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.cpp.auto_frac.hints/">Automatic Fractional Splitting</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.cpp.breakpoints/">Using breakpoints</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.cpp.cpp_proof/">The <code>verify</code> notation</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.cpp.delayed_case_tactics/">Join points</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.cpp.elpi.derive.bi/">Derive instances for BI predicates</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.cpp.hints.fractional/">Common UNSAFE hints for <code>primR</code></a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.cpp.specs.inline/">Inlining during verification</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="./" aria-current="&quot;page&quot;">The <code>cpp.class</code> command</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.elpi.cpp_enum/">The <code>cpp.enum</code> command</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.elpi.cpp_spec/">The <code>cpp.spec</code> command</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.elpi.derive.bwd/">Derive <code>Bwd</code> hints</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.elpi.derive.cancel/">Derive <code>Cancel</code> hints</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.elpi.derive.eager_unfold/">Derive Eager unfolding hints</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.elpi.derive.equiv/">Derive equivalences for predicates</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.elpi.derive.fwd/">Derive <code>Fwd</code> hints</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.elpi.derive.hint_opaque/">Derive <code>Hint Opaque</code> annotations</a>
</li>


        
      
        
          

<li class="mb-1">
  <a class="nav-link" style="margin-left: 1.5rem" href="../bluerock.auto.elpi.derive.lazy_unfold/">Derive Lazy unfolding hints</a>
</li>


        
      
    </ul>
  </div>
</li>


      
    
      
        


      
    
      
        


      
    
  </ul>
</div>

      </aside>
      <main class="bd-main order-1">
        
<h1>The `cpp.class` command</h1>


<div class="alert alert-info" role="alert">
  Available from <code>bluerock.auto.elpi.cpp_class</code>.
</div>


<h2>Usage</h2>
<pre class="language-coq"><code class="language-coq"><span class="token attribute attr-name"><span class="token punctuation">#[</span>verbose<span class="token punctuation">,</span> debug<span class="token punctuation">]</span></span>
<span class="token attribute attr-name"><span class="token punctuation">#[</span>unsafe_learn_hint<span class="token operator">=</span>local|export|global|none<span class="token punctuation">]</span></span> <span class="token comment">(* Register unsafe learning hint? (default `global`) *)</span>
cpp<span class="token punctuation">.</span>class <span class="token operator">&lt;</span>matcher<span class="token operator">></span> <span class="token punctuation">[</span> prefix <span class="token string">"prefix"</span> <span class="token punctuation">]</span> from <span class="token operator">&lt;</span>translation<span class="token operator">-</span>unit<span class="token operator">-</span>name<span class="token operator">></span> <span class="token operator">&lt;</span>rep<span class="token operator">></span>
  <span class="token punctuation">[</span> <span class="token punctuation">{</span> <span class="token operator">&lt;</span>class<span class="token operator">-</span>attr<span class="token operator">></span> <span class="token punctuation">;</span> <span class="token operator">...</span> <span class="token punctuation">;</span> <span class="token operator">&lt;</span>class<span class="token operator">-</span>attr<span class="token operator">></span> <span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">.</span></code></pre>
<p>where</p>
<pre class="language-coq"><code class="language-coq">  <span class="token operator">&lt;</span>matcher<span class="token operator">></span> <span class="token operator">::=</span>
    <span class="token string">"className"</span>       <span class="token comment">(* E.g. `"Namespace::Foo"` *)</span>
  <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>matcher<span class="token operator">-</span>expr<span class="token operator">></span><span class="token punctuation">)</span>  <span class="token comment">(* E.g. `(name "Foo")` or `(exact "Foo")` *)</span>

  <span class="token operator">&lt;</span>rep<span class="token operator">></span> <span class="token operator">::=</span>
    dataclass <span class="token punctuation">[</span> <span class="token punctuation">[</span> <span class="token operator">&lt;</span>dataclass<span class="token operator">-</span>attr<span class="token operator">></span> <span class="token punctuation">;</span> <span class="token operator">...</span> <span class="token punctuation">;</span> <span class="token operator">&lt;</span>dataclass<span class="token operator">-</span>attr<span class="token operator">></span> <span class="token punctuation">]</span> <span class="token punctuation">]</span>
  <span class="token operator">|</span> rep <span class="token operator">&lt;</span>rep<span class="token operator">-</span>name<span class="token operator">></span>

  <span class="token operator">&lt;</span>dataclass<span class="token operator">-</span>attr<span class="token operator">></span> <span class="token operator">::=</span>
    no_register     <span class="token comment">(* Forget about any freshly synthesized model, rep *)</span>
  <span class="token operator">|</span> no_cfrac        <span class="token comment">(* Do not synthesize a `CFracSplittable` instance *)</span>

  <span class="token operator">&lt;</span>class<span class="token operator">-</span>attr<span class="token operator">></span> <span class="token operator">::=</span>  <span class="token comment">(* Additional specs to synthesize *)</span>
    defaultable     <span class="token comment">(* default constructor *)</span>
  <span class="token operator">|</span> destructible    <span class="token comment">(* destructor *)</span>
  <span class="token operator">|</span> copyable        <span class="token comment">(* copy constructor, copy assignment *)</span>
  <span class="token operator">|</span> movable         <span class="token comment">(* move constructor, move assignment *)</span>
  <span class="token operator">|</span> default_specs   <span class="token comment">(* all supported default methods in the TU, and an abbreviation for the lot *)</span></code></pre>
<h2>Examples</h2>
<p>We consider the C++ code</p>
<pre class="language-cpp"><code class="language-cpp"><span class="token comment">// dataclass_demo.hpp</span>
<span class="token keyword">namespace</span> Test <span class="token punctuation">{</span>
  <span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> x<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> some_client_data<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> other_client_data<span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> client_has_feature_X<span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<h3>Using <code>prefix</code></h3>
<pre class="language-coq"><code class="language-coq"><span class="token keyword">Module</span> Base<span class="token punctuation">.</span>
  cpp<span class="token punctuation">.</span>class <span class="token string">"Test::Base"</span>
    prefix <span class="token string">""</span>
    from dataclass_demo_hpp<span class="token punctuation">.</span>source
    dataclass<span class="token punctuation">[</span>no_cfrac<span class="token punctuation">]</span>
    <span class="token punctuation">{</span> defaultable
    <span class="token punctuation">;</span> copyable
    <span class="token punctuation">;</span> movable <span class="token punctuation">}</span><span class="token punctuation">.</span>
<span class="token keyword">End</span> Base<span class="token punctuation">.</span></code></pre>
<p>generates, among many things,</p>
<ul>
<li>the model <code>T</code></li>
<li>the representation predicate <code>R</code></li>
<li>a <code>default</code> value of type <code>T</code></li>
<li>the specifications for constructors (including default and copy constructors),
destructors, and copy assignment and move assignment operators</li>
<li>various properties (but not <code>CFracSplittable</code>), learning hints
and unfolding hints for <code>R</code></li>
</ul>
<p>As the generated definitions are put inside the <code>Module Base</code> with empty prefix,
we can refer to them as, for example, <code>Base.T</code> and <code>Base.R</code>,
and <code>Base.default_ctor_spec</code>.</p>
<p>Meanwhile,</p>
<pre class="language-coq"><code class="language-coq">cpp<span class="token punctuation">.</span>class <span class="token punctuation">(</span>exact <span class="token string">"Test::Client"</span><span class="token punctuation">)</span>
  prefix <span class="token string">"Base_"</span>
  from dataclass_demo_hpp<span class="token punctuation">.</span>source
  dataclass
  <span class="token punctuation">{</span> default_specs <span class="token punctuation">}</span><span class="token punctuation">.</span></code></pre>
<p>generates <code>Base_T</code> and <code>Base_R</code> and <code>Base_default_ctor_spec</code>, and so on.
<code>(exact &quot;Test::Client&quot;)</code> is a matcher expression.</p>
<h3>Using <code>dataclass</code></h3>
<p><code>dataclass</code> generates the model <code>T</code> as a <code>Record</code>, using the fields of the C++
class/struct, mapping primitives to their known Rocq types (e.g. <code>int</code> to <code>Z</code>)
and internal classes/structs to the models registered with <code>dataclass</code>
(e.g. those also generated by <code>cpp.class</code>).
Meanwhile, the predicates <code>R</code> has type <code>cQp.t -&gt; T -&gt; Rep</code>.</p>
<p>For example, in</p>
<pre class="language-coq"><code class="language-coq"><span class="token keyword">Module</span> Base<span class="token punctuation">.</span>
  cpp<span class="token punctuation">.</span>class <span class="token string">"Test::Base"</span>
    prefix <span class="token string">""</span>
    from dataclass_demo_hpp<span class="token punctuation">.</span>source
    dataclass
    <span class="token punctuation">{</span> defaultable
    <span class="token punctuation">;</span> copyable
    <span class="token punctuation">;</span> movable <span class="token punctuation">}</span><span class="token punctuation">.</span>
<span class="token keyword">End</span> Base<span class="token punctuation">.</span>

<span class="token keyword">Module</span> Client<span class="token punctuation">.</span>
  cpp<span class="token punctuation">.</span>class <span class="token string">"Test::Client"</span>
    prefix <span class="token string">""</span>
    from dataclass_demo_hpp<span class="token punctuation">.</span>source
    dataclass<span class="token punctuation">[</span>no_register<span class="token punctuation">]</span><span class="token punctuation">.</span>
<span class="token keyword">End</span> Client<span class="token punctuation">.</span></code></pre>
<p><code>Print Client.T.</code> gives</p>
<pre class="language-coq"><code class="language-coq"><span class="token keyword">Record</span> T <span class="token punctuation">:</span> <span class="token keyword">Set</span> <span class="token operator">:=</span> Build_T <span class="token punctuation">{</span>
  Test_dot_Base <span class="token punctuation">:</span> Base<span class="token punctuation">.</span>T<span class="token punctuation">;</span>
	some_client_data <span class="token punctuation">:</span> Z<span class="token punctuation">;</span>
  other_client_data <span class="token punctuation">:</span> Z<span class="token punctuation">;</span>
  client_has_feature_X <span class="token punctuation">:</span> bool
<span class="token punctuation">}</span> <span class="token keyword">as</span> record<span class="token punctuation">.</span></code></pre>
<p>In <code>Module Client</code>, we use <code>dataclass[no_register]</code> to avoid registering the
to-be-generated definitions with the <code>dataclass</code> database for known models.</p>
<h3>Using existing handwritten model and predicate</h3>
<pre class="language-coq"><code class="language-coq"><span class="token keyword">Record</span> MyModel <span class="token punctuation">:</span> <span class="token keyword">Set</span> <span class="token operator">:=</span> mkMyModel <span class="token punctuation">{</span> x <span class="token punctuation">:</span> Z<span class="token punctuation">;</span> client <span class="token punctuation">:</span> Client<span class="token punctuation">.</span>T <span class="token punctuation">}</span><span class="token punctuation">.</span>

<span class="token keyword">Definition</span> I <span class="token punctuation">(</span>m <span class="token punctuation">:</span> MyModel<span class="token punctuation">)</span> <span class="token operator">:=</span>
  m<span class="token punctuation">.(</span>client<span class="token punctuation">)</span><span class="token punctuation">.(</span>Client<span class="token punctuation">.</span>some_client_data<span class="token punctuation">)</span> <span class="token operator">=</span> m<span class="token punctuation">.(</span>client<span class="token punctuation">)</span><span class="token punctuation">.(</span>Client<span class="token punctuation">.</span>other_client_data<span class="token punctuation">)</span><span class="token punctuation">.</span>

br<span class="token punctuation">.</span>lock <span class="token keyword">Definition</span> Client_R <span class="token punctuation">`{</span>Σ <span class="token punctuation">:</span> cpp_logic<span class="token punctuation">,</span> σ <span class="token punctuation">:</span> genv<span class="token punctuation">}</span> <span class="token punctuation">(</span>q <span class="token punctuation">:</span> cQp<span class="token punctuation">.</span>t<span class="token punctuation">)</span> <span class="token punctuation">(</span>m <span class="token punctuation">:</span> MyModel<span class="token punctuation">)</span> <span class="token punctuation">:</span> Rep <span class="token operator">:=</span>
  pureR <span class="token punctuation">[</span><span class="token operator">|</span> I m <span class="token operator">|</span><span class="token punctuation">]</span> <span class="token operator">**</span> Client<span class="token punctuation">.</span>R q m<span class="token punctuation">.(</span>client<span class="token punctuation">)</span><span class="token punctuation">.</span>

cpp<span class="token punctuation">.</span>class <span class="token string">"Test::Client"</span>
  from dataclass_demo_hpp<span class="token punctuation">.</span>source
  rep Client_R
  <span class="token punctuation">{</span> copyable
  <span class="token punctuation">;</span> movable <span class="token punctuation">}</span><span class="token punctuation">.</span></code></pre>
<p>generates various hints and properites for <code>Client_R</code>, as well as specifications
for copy/move contructors and assignment operators that use <code>MyModel</code> and <code>Client_R</code>.
The generated definitions are prefixed by default with <code>Test_Client_</code>, for example,
<code>Test_Client_copy_ctor_spec</code> and <code>Test_Client_copy_assign_spec</code>.</p>
<h3>Using model and predicate generated by <code>derive</code></h3>
<div class="alert alert-warning" role="alert">
<p>This approach with <code>derive</code> clutters the environment with <code>CppKey</code>s and so is not recommended.</p>
</div>
<pre class="language-coq"><code class="language-coq"><span class="token keyword">Definition</span> Base <span class="token operator">:=</span> CppKey dataclass_demo_hpp<span class="token punctuation">.</span>source <span class="token string">"Test::Base"</span><span class="token punctuation">.</span>
<span class="token attribute attr-name"><span class="token punctuation">#[</span>only<span class="token punctuation">(</span>cpp_model<span class="token punctuation">,</span>cpp_rep<span class="token punctuation">,</span>default_ctor<span class="token punctuation">)</span><span class="token punctuation">]</span></span> derive Base<span class="token punctuation">.</span>

<span class="token keyword">Definition</span> Client <span class="token operator">:=</span> CppKey dataclass_demo_hpp<span class="token punctuation">.</span>source <span class="token string">"Test::Client"</span><span class="token punctuation">.</span>
<span class="token attribute attr-name"><span class="token punctuation">#[</span>only<span class="token punctuation">(</span>cpp_model<span class="token punctuation">)</span><span class="token punctuation">]</span></span> derive Client<span class="token punctuation">.</span>
<span class="token attribute attr-name"><span class="token punctuation">#[</span>only<span class="token punctuation">(</span>cpp_rep<span class="token punctuation">)</span><span class="token punctuation">]</span></span> derive Client<span class="token punctuation">.</span>
cpp<span class="token punctuation">.</span>class <span class="token punctuation">(</span>exact <span class="token string">"Test::Client"</span><span class="token punctuation">)</span>
  prefix <span class="token string">""</span>
  from dataclass_demo_hpp<span class="token punctuation">.</span>source
  rep Client_R
  <span class="token punctuation">{</span> defaultable
  <span class="token punctuation">;</span> copyable
  <span class="token punctuation">;</span> movable <span class="token punctuation">}</span><span class="token punctuation">.</span></code></pre>


      </main>
    </div>

    <footer class="bd-footer py-4 py-md-5 mt-5 bg-body-tertiary">
      <center>
        <small>BlueRock Security, Inc. 2025
      </small></center>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/lunr/lunr.js"></script>
    <script>
        (async function() {
            const searchInput = document.getElementById('searchInput');
            const searchGroup = document.getElementById('searchGroup');
            const searchResults = document.createElement('div');
            searchResults.id = 'searchResults';
            searchResults.classList.add('list-group', 'mt-0');
            searchGroup.appendChild(searchResults);

            let idx;
            let docs;

            try {
                const response = await fetch("/auto-docs/search-index.json");
                docs = await response.json();

                idx = lunr(function () {
                    this.ref('url');
                    this.field('title');
                    this.field('content');

                    docs.forEach(function (doc) {
                        this.add(doc);
                    }, this);
                });
            } catch (error) {
                console.error('Error loading search index:', error);
                return;
            }

            searchInput.addEventListener('input', function() {
                const query = this.value;
                searchResults.innerHTML = '';

                if (query.length > 2) {
                    const results = idx.search(query);
                    results.forEach(result => {
                        const doc = docs.find(d => d.url === result.ref);
                        if (doc) {
                            const a = document.createElement('a');
                            a.href = '/auto-docs' + doc.url;
                            a.classList.add('list-group-item', 'list-group-item-action');
                            a.textContent = doc.title;
                            searchResults.appendChild(a);
                        }
                    });
                }
            });
        })();
    </script>
</body>
</html>
